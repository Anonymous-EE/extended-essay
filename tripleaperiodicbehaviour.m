clear
[t,y] = ode113(@vdp1,[0 50],[pi/2; 0; pi/2; 0; pi/2; 0]);
l = 1;
x1 = (l/3)*sin(y(:,1));
y1 = (-l/3)*cos(y(:,1));
x2 = (l/3)*(sin(y(:,1)) + sin(y(:,3)));
y2 = (l/3)*(-cos(y(:,1)) - cos(y(:,3)));
x3 = (l/3)*(sin(y(:,1)) + sin(y(:,3)) + sin(y(:,5))); y3 = (l/3)*(-cos(y(:,1)) - cos(y(:,3)) - cos(y(:,5)));
plot (t, y(:,5)) 
xlabel('time') 
ylabel('theta 3')

function dydt = vdp1(t,y)
dydt = [y(2); -(588*cos(y(3))^2*cos(y(5))^2*sin(y(1)) + 441*cos(y(3))^2*sin(y(1))*sin(y(5))^2 - 441*cos(y(1))*cos(y(3))*cos(y(5))^2*sin(y(3)) - 147*cos(y(1))*cos(y(3))^2*cos(y(5))*sin(y(5)) - 588*cos(y(1))*cos(y(3))*sin(y(3))*sin(y(5))^2 - 15*cos(y(1))*cos(y(5))^2*sin(y(3))^3*y(4)^2 + 20*cos(y(3))^3*cos(y(5))^2*sin(y(1))*y(4)^2 - 5*cos(y(1))*cos(y(3))^2*sin(y(5))^3*y(6)^2 + 10*cos(y(3))^2*cos(y(5))^3*sin(y(1))*y(6)^2 - 20*cos(y(1))*sin(y(3))^3*sin(y(5))^2*y(4)^2 + 15*cos(y(3))^3*sin(y(1))*sin(y(5))^2*y(4)^2 - 10*cos(y(1))*sin(y(3))^2*sin(y(5))^3*y(6)^2 + 5*cos(y(5))^3*sin(y(1))*sin(y(3))^2*y(6)^2 + 147*cos(y(3))*cos(y(5))*sin(y(1))*sin(y(3))*sin(y(5)) - 5*cos(y(1))*cos(y(3))*cos(y(5))^3*sin(y(3))*y(6)^2 - 5*cos(y(1))*cos(y(3))^3*cos(y(5))*sin(y(5))*y(4)^2 + 5*cos(y(3))*sin(y(1))*sin(y(3))*sin(y(5))^3*y(6)^2 + 5*cos(y(5))*sin(y(1))*sin(y(3))^3*sin(y(5))*y(4)^2 + 15*cos(y(1))*cos(y(3))^2*cos(y(5))^2*sin(y(1))*y(2)^2 - 10*cos(y(1))^2*cos(y(3))*cos(y(5))^2*sin(y(3))*y(2)^2 - 15*cos(y(1))*cos(y(3))^2*cos(y(5))^2*sin(y(3))*y(4)^2 - 5*cos(y(1))^2*cos(y(3))^2*cos(y(5))*sin(y(5))*y(2)^2 - 5*cos(y(1))*cos(y(3))^2*cos(y(5))^2*sin(y(5))*y(6)^2 + 5*cos(y(1))*cos(y(3))^2*sin(y(1))*sin(y(5))^2*y(2)^2 - 5*cos(y(1))*cos(y(5))^2*sin(y(1))*sin(y(3))^2*y(2)^2 + 10*cos(y(3))*cos(y(5))^2*sin(y(1))^2*sin(y(3))*y(2)^2 - 10*cos(y(1))^2*cos(y(3))*sin(y(3))*sin(y(5))^2*y(2)^2 - 20*cos(y(1))*cos(y(3))^2*sin(y(3))*sin(y(5))^2*y(4)^2 + 20*cos(y(3))*cos(y(5))^2*sin(y(1))*sin(y(3))^2*y(4)^2 - 5*cos(y(1))^2*cos(y(5))*sin(y(3))^2*sin(y(5))*y(2)^2 + 5*cos(y(3))^2*cos(y(5))*sin(y(1))^2*sin(y(5))*y(2)^2 - 10*cos(y(1))*cos(y(5))^2*sin(y(3))^2*sin(y(5))*y(6)^2 + 10*cos(y(3))^2*cos(y(5))*sin(y(1))*sin(y(5))^2*y(6)^2 - 15*cos(y(1))*sin(y(1))*sin(y(3))^2*sin(y(5))^2*y(2)^2 + 10*cos(y(3))*sin(y(1))^2*sin(y(3))*sin(y(5))^2*y(2)^2 + 15*cos(y(3))*sin(y(1))*sin(y(3))^2*sin(y(5))^2*y(4)^2 + 5*cos(y(5))*sin(y(1))^2*sin(y(3))^2*sin(y(5))*y(2)^2 + 5*cos(y(5))*sin(y(1))*sin(y(3))^2*sin(y(5))^2*y(6)^2 - 5*cos(y(1))*cos(y(3))*cos(y(5))*sin(y(3))^2*sin(y(5))*y(4)^2 - 5*cos(y(1))*cos(y(3))*cos(y(5))*sin(y(3))*sin(y(5))^2*y(6)^2 + 5*cos(y(3))^2*cos(y(5))*sin(y(1))*sin(y(3))*sin(y(5))*y(4)^2 + 5*cos(y(3))*cos(y(5))^2*sin(y(1))*sin(y(3))*sin(y(5))*y(6)^2)/(5*(sin(y(1))^2*sin(y(3))^2*sin(y(5))^2 + cos(y(1))^2*cos(y(3))^2*cos(y(5))^2 + 2*cos(y(1))^2*cos(y(3))^2*sin(y(5))^2 + 3*cos(y(1))^2*cos(y(5))^2*sin(y(3))^2 + 4*cos(y(3))^2*cos(y(5))^2*sin(y(1))^2 + 4*cos(y(1))^2*sin(y(3))^2*sin(y(5))^2 + 3*cos(y(3))^2*sin(y(1))^2*sin(y(5))^2 + 2*cos(y(5))^2*sin(y(1))^2*sin(y(3))^2 - 4*cos(y(1))*cos(y(3))*cos(y(5))^2*sin(y(1))*sin(y(3)) - 2*cos(y(1))*cos(y(3))^2*cos(y(5))*sin(y(1))*sin(y(5)) - 4*cos(y(1))*cos(y(3))*sin(y(1))*sin(y(3))*sin(y(5))^2 - 2*cos(y(1))*cos(y(5))*sin(y(1))*sin(y(3))^2*sin(y(5)))); y(4); - (441*cos(y(1))^2*cos(y(5))^2*sin(y(3)) + 588*cos(y(1))^2*sin(y(3))*sin(y(5))^2 + 294*cos(y(5))^2*sin(y(1))^2*sin(y(3)) + 147*sin(y(1))^2*sin(y(3))*sin(y(5))^2 - 294*cos(y(1))*cos(y(3))*cos(y(5))^2*sin(y(1)) - 294*cos(y(1))*cos(y(3))*sin(y(1))*sin(y(5))^2 - 10*cos(y(3))*cos(y(5))^2*sin(y(1))^3*y(2)^2 + 10*cos(y(1))^3*cos(y(5))^2*sin(y(3))*y(2)^2 + 5*cos(y(1))^2*cos(y(5))^3*sin(y(3))*y(6)^2 - 10*cos(y(3))*sin(y(1))^3*sin(y(5))^2*y(2)^2 + 10*cos(y(1))^3*sin(y(3))*sin(y(5))^2*y(2)^2 - 5*cos(y(3))*sin(y(1))^2*sin(y(5))^3*y(6)^2 - 294*cos(y(1))*cos(y(5))*sin(y(1))*sin(y(3))*sin(y(5)) - 5*cos(y(1))*cos(y(3))*cos(y(5))^3*sin(y(1))*y(6)^2 + 5*cos(y(1))*sin(y(1))*sin(y(3))*sin(y(5))^3*y(6)^2 - 10*cos(y(1))^2*cos(y(3))*cos(y(5))^2*sin(y(1))*y(2)^2 - 10*cos(y(1))*cos(y(3))^2*cos(y(5))^2*sin(y(1))*y(4)^2 + 10*cos(y(1))^2*cos(y(3))*cos(y(5))^2*sin(y(3))*y(4)^2 + 10*cos(y(1))*cos(y(5))^2*sin(y(1))^2*sin(y(3))*y(2)^2 - 10*cos(y(1))^2*cos(y(3))*sin(y(1))*sin(y(5))^2*y(2)^2 - 10*cos(y(1))*cos(y(3))^2*sin(y(1))*sin(y(5))^2*y(4)^2 + 10*cos(y(1))*cos(y(5))^2*sin(y(1))*sin(y(3))^2*y(4)^2 - 10*cos(y(3))*cos(y(5))^2*sin(y(1))^2*sin(y(3))*y(4)^2 + 10*cos(y(1))^2*cos(y(3))*sin(y(3))*sin(y(5))^2*y(4)^2 - 5*cos(y(3))*cos(y(5))^2*sin(y(1))^2*sin(y(5))*y(6)^2 + 5*cos(y(1))^2*cos(y(5))*sin(y(3))*sin(y(5))^2*y(6)^2 + 10*cos(y(1))*sin(y(1))^2*sin(y(3))*sin(y(5))^2*y(2)^2 + 10*cos(y(1))*sin(y(1))*sin(y(3))^2*sin(y(5))^2*y(4)^2 - 10*cos(y(3))*sin(y(1))^2*sin(y(3))*sin(y(5))^2*y(4)^2 - 5*cos(y(1))*cos(y(3))*cos(y(5))*sin(y(1))*sin(y(5))^2*y(6)^2 + 5*cos(y(1))*cos(y(5))^2*sin(y(1))*sin(y(3))*sin(y(5))*y(6)^2)/(5*(sin(y(1))^2*sin(y(3))^2*sin(y(5))^2 + cos(y(1))^2*cos(y(3))^2*cos(y(5))^2 + 2*cos(y(1))^2*cos(y(3))^2*sin(y(5))^2 + 3*cos(y(1))^2*cos(y(5))^2*sin(y(3))^2 + 4*cos(y(3))^2*cos(y(5))^2*sin(y(1))^2 + 4*cos(y(1))^2*sin(y(3))^2*sin(y(5))^2 + 3*cos(y(3))^2*sin(y(1))^2*sin(y(5))^2 + 2*cos(y(5))^2*sin(y(1))^2*sin(y(3))^2 - 4*cos(y(1))*cos(y(3))*cos(y(5))^2*sin(y(1))*sin(y(3)) - 2*cos(y(1))*cos(y(3))^2*cos(y(5))*sin(y(1))*sin(y(5)) - 4*cos(y(1))*cos(y(3))*sin(y(1))*sin(y(3))*sin(y(5))^2 - 2*cos(y(1))*cos(y(5))*sin(y(1))*sin(y(3))^2*sin(y(5)))); y(6); -((cos(y(1))*sin(y(5)) - cos(y(5))*sin(y(1)))*(294*cos(y(1))*cos(y(3))^2 + 10*cos(y(1))*cos(y(3))^3*y(4)^2 + 10*sin(y(1))*sin(y(3))^3*y(4)^2 + 10*cos(y(1))^2*cos(y(3))^2*y(2)^2 + 10*cos(y(1))^2*sin(y(3))^2*y(2)^2 + 10*cos(y(3))^2*sin(y(1))^2*y(2)^2 + 10*sin(y(1))^2*sin(y(3))^2*y(2)^2 + 294*cos(y(3))*sin(y(1))*sin(y(3)) + 5*cos(y(1))*cos(y(3))^2*cos(y(5))*y(6)^2 + 10*cos(y(1))*cos(y(3))*sin(y(3))^2*y(4)^2 + 5*cos(y(1))*cos(y(5))*sin(y(3))^2*y(6)^2 + 10*cos(y(3))^2*sin(y(1))*sin(y(3))*y(4)^2 + 5*cos(y(3))^2*sin(y(1))*sin(y(5))*y(6)^2 + 5*sin(y(1))*sin(y(3))^2*sin(y(5))*y(6)^2))/(5*(sin(y(1))^2*sin(y(3))^2*sin(y(5))^2 + cos(y(1))^2*cos(y(3))^2*cos(y(5))^2 + 2*cos(y(1))^2*cos(y(3))^2*sin(y(5))^2 + 3*cos(y(1))^2*cos(y(5))^2*sin(y(3))^2 + 4*cos(y(3))^2*cos(y(5))^2*sin(y(1))^2 + 4*cos(y(1))^2*sin(y(3))^2*sin(y(5))^2 + 3*cos(y(3))^2*sin(y(1))^2*sin(y(5))^2 + 2*cos(y(5))^2*sin(y(1))^2*sin(y(3))^2 - 4*cos(y(1))*cos(y(3))*cos(y(5))^2*sin(y(1))*sin(y(3)) - 2*cos(y(1))*cos(y(3))^2*cos(y(5))*sin(y(1))*sin(y(5)) - 4*cos(y(1))*cos(y(3))*sin(y(1))*sin(y(3))*sin(y(5))^2 - 2*cos(y(1))*cos(y(5))*sin(y(1))*sin(y(3))^2*sin(y(5))))]
end